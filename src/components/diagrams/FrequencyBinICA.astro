---
---

<div class="container">
  <h3 class="diagram-title">各周波数ビンごとのICA処理</h3>
  
  <div class="diagram">
    <svg width="750" height="400">
      {/* 周波数ビン f=3 のデータ */}
      <rect x="50" y="50" width="320" height="50" fill="rgba(255, 200, 0, 0.3)" stroke="orange" strokeWidth="2" />
      <text x="210" y="40" textAnchor="middle" fontWeight="bold" fill="var(--content-color)">周波数ビン f=3 のデータ</text>
      <text x="210" y="115" textAnchor="middle" fontSize="12" fill="var(--content-color)">（時間×チャネル数の行列）</text>
      
      {/* 各時間フレームの複素数データ */}
      <text x="40" y="70" textAnchor="end" fontSize="10" fill="var(--content-color)">マイク1</text>
      <text x="40" y="90" textAnchor="end" fontSize="10" fill="var(--content-color)">マイク2</text>
      
      {/* 下付き添字を使った表現 */}
      <rect x="70" y="60" width="36" height="20" fill="rgba(255, 255, 255, 0.1)" stroke="gray" strokeWidth="1" />
      <text x="88" y="74" textAnchor="middle" fontSize="9" fill="var(--content-color)">
        X<tspan fontSize="7" dy="2">3</tspan>(1,1)
      </text>
      
      <rect x="110" y="60" width="36" height="20" fill="rgba(255, 255, 255, 0.1)" stroke="gray" strokeWidth="1" />
      <text x="128" y="74" textAnchor="middle" fontSize="9" fill="var(--content-color)">
        X<tspan fontSize="7" dy="2">3</tspan>(2,1)
      </text>
      
      <rect x="150" y="60" width="36" height="20" fill="rgba(255, 255, 255, 0.1)" stroke="gray" strokeWidth="1" />
      <text x="168" y="74" textAnchor="middle" fontSize="9" fill="var(--content-color)">
        X<tspan fontSize="7" dy="2">3</tspan>(3,1)
      </text>
      
      <rect x="190" y="60" width="36" height="20" fill="rgba(255, 255, 255, 0.1)" stroke="gray" strokeWidth="1" />
      <text x="208" y="74" textAnchor="middle" fontSize="9" fill="var(--content-color)">
        X<tspan fontSize="7" dy="2">3</tspan>(4,1)
      </text>
      
      <rect x="230" y="60" width="36" height="20" fill="rgba(255, 255, 255, 0.1)" stroke="gray" strokeWidth="1" />
      <text x="248" y="74" textAnchor="middle" fontSize="9" fill="var(--content-color)">
        X<tspan fontSize="7" dy="2">3</tspan>(5,1)
      </text>
      
      <rect x="270" y="60" width="36" height="20" fill="rgba(255, 255, 255, 0.1)" stroke="gray" strokeWidth="1" />
      <text x="288" y="74" textAnchor="middle" fontSize="9" fill="var(--content-color)">
        X<tspan fontSize="7" dy="2">3</tspan>(6,1)
      </text>
      
      <rect x="310" y="60" width="36" height="20" fill="rgba(255, 255, 255, 0.1)" stroke="gray" strokeWidth="1" />
      <text x="328" y="74" textAnchor="middle" fontSize="9" fill="var(--content-color)">
        X<tspan fontSize="7" dy="2">3</tspan>(7,1)
      </text>
      
      <rect x="70" y="80" width="36" height="20" fill="rgba(255, 255, 255, 0.1)" stroke="gray" strokeWidth="1" />
      <text x="88" y="94" textAnchor="middle" fontSize="9" fill="var(--content-color)">
        X<tspan fontSize="7" dy="2">3</tspan>(1,2)
      </text>
      
      <rect x="110" y="80" width="36" height="20" fill="rgba(255, 255, 255, 0.1)" stroke="gray" strokeWidth="1" />
      <text x="128" y="94" textAnchor="middle" fontSize="9" fill="var(--content-color)">
        X<tspan fontSize="7" dy="2">3</tspan>(2,2)
      </text>
      
      <rect x="150" y="80" width="36" height="20" fill="rgba(255, 255, 255, 0.1)" stroke="gray" strokeWidth="1" />
      <text x="168" y="94" textAnchor="middle" fontSize="9" fill="var(--content-color)">
        X<tspan fontSize="7" dy="2">3</tspan>(3,2)
      </text>
      
      <rect x="190" y="80" width="36" height="20" fill="rgba(255, 255, 255, 0.1)" stroke="gray" strokeWidth="1" />
      <text x="208" y="94" textAnchor="middle" fontSize="9" fill="var(--content-color)">
        X<tspan fontSize="7" dy="2">3</tspan>(4,2)
      </text>
      
      <rect x="230" y="80" width="36" height="20" fill="rgba(255, 255, 255, 0.1)" stroke="gray" strokeWidth="1" />
      <text x="248" y="94" textAnchor="middle" fontSize="9" fill="var(--content-color)">
        X<tspan fontSize="7" dy="2">3</tspan>(5,2)
      </text>
      
      <rect x="270" y="80" width="36" height="20" fill="rgba(255, 255, 255, 0.1)" stroke="gray" strokeWidth="1" />
      <text x="288" y="94" textAnchor="middle" fontSize="9" fill="var(--content-color)">
        X<tspan fontSize="7" dy="2">3</tspan>(6,2)
      </text>
      
      <rect x="310" y="80" width="36" height="20" fill="rgba(255, 255, 255, 0.1)" stroke="gray" strokeWidth="1" />
      <text x="328" y="94" textAnchor="middle" fontSize="9" fill="var(--content-color)">
        X<tspan fontSize="7" dy="2">3</tspan>(7,2)
      </text>
      
      {/* ICAへの矢印 */}
      <line x1="210" y1="130" x2="210" y2="160" stroke="var(--content-color)" strokeWidth="2" />
      <polygon points="210,160 205,150 215,150" fill="var(--content-color)" />
      <text x="225" y="145" textAnchor="start" fontSize="12" fill="var(--content-color)">ICA適用</text>
      <text x="225" y="160" textAnchor="start" fontSize="10" fill="var(--content-color)">（f=3のみで独立に処理）</text>
      
      {/* ICAの数式表現 */}
      <rect x="110" y="180" width="200" height="80" fill="rgba(50, 50, 50, 0.2)" stroke="var(--front-blue)" strokeWidth="1" rx="5" />
      <text x="210" y="200" textAnchor="middle" fontSize="16" fill="var(--content-color)">
        X<tspan fontSize="12" dy="2">3</tspan> = A<tspan fontSize="12" dy="2">3</tspan> S<tspan fontSize="12" dy="2">3</tspan>
      </text>
      <text x="210" y="230" textAnchor="middle" fontSize="16" fill="var(--content-color)">
        S<tspan fontSize="12" dy="2">3</tspan> = A<tspan fontSize="12" dy="2">3</tspan><tspan dy="-3">-1</tspan> X<tspan fontSize="12" dy="2">3</tspan>
      </text>
      <text x="210" y="250" textAnchor="middle" fontSize="12" fill="var(--content-color)">（f=3での混合・分離モデル）</text>
      
      {/* 各周波数での分離行列と結果 */}
      <text x="380" y="60" textAnchor="start" fontWeight="bold" fill="var(--content-color)">各周波数ビンごとの分離行列:</text>
      <text x="400" y="80" textAnchor="start" fill="var(--content-color)">・f=1: A<tspan fontSize="10" dy="2">1</tspan><tspan dy="-2">-1</tspan></text>
      <text x="400" y="100" textAnchor="start" fill="var(--content-color)">・f=2: A<tspan fontSize="10" dy="2">2</tspan><tspan dy="-2">-1</tspan></text>
      <text x="400" y="120" textAnchor="start" fill="var(--article-anchor-color)">・f=3: A<tspan fontSize="10" dy="2">3</tspan><tspan dy="-2">-1</tspan> ← 現在処理中</text>
      <text x="400" y="140" textAnchor="start" fill="var(--content-color)">・f=4: A<tspan fontSize="10" dy="2">4</tspan><tspan dy="-2">-1</tspan></text>
      <text x="400" y="160" textAnchor="start" fill="var(--content-color)">・f=5: A<tspan fontSize="10" dy="2">5</tspan><tspan dy="-2">-1</tspan></text>
      
      {/* データ形式の説明 */}
      <rect x="50" y="280" width="650" height="90" fill="rgba(50, 50, 50, 0.2)" stroke="var(--front-blue)" strokeWidth="1" />
      <text x="60" y="300" textAnchor="start" fontWeight="bold" fill="var(--content-color)">データ形式と処理手順:</text>
      <text x="60" y="320" textAnchor="start" fontSize="12" fill="var(--content-color)">1. 時間-周波数領域のデータは通常 [周波数ビン数 × 時間フレーム数 × チャネル数] の3次元配列</text>
      <text x="60" y="340" textAnchor="start" fontSize="12" fill="var(--content-color)">2. 各周波数ビンfでのデータX<tspan fontSize="10" dy="2">f</tspan>は [時間フレーム数 × チャネル数] の2次元行列</text>
      <text x="60" y="360" textAnchor="start" fontSize="12" fill="var(--content-color)">3. 各周波数ビンの2次元行列に対して、独立にICAアルゴリズムを適用し、分離行列A<tspan fontSize="10" dy="2">f</tspan><tspan dy="-2">-1</tspan>を求める</text>
    </svg>
  </div>
  
  <div class="diagram-caption">
    各周波数ビンは時間×チャネル数の行列として扱われ、それぞれに独立してICAが適用されます。
    各周波数ビンごとに独自の分離行列A<sub>f</sub><sup>-1</sup>が求められます。
  </div>
</div>

<style>
  .container {
    margin: 2rem 0;
    padding: 1.5rem;
    background-color: rgba(18, 18, 18, 0.7);
    border: 1px solid rgba(138, 115, 85, 0.15);
    border-radius: 8px;
  }
  
  .diagram-title {
    font-size: 1.3rem;
    margin-top: 0;
    margin-bottom: 1.5rem;
    color: var(--content-color);
    text-align: center;
  }
  
  .diagram {
    display: flex;
    justify-content: center;
    overflow-x: auto;
    margin-bottom: 1rem;
  }
  
  .diagram-caption {
    font-size: 0.9rem;
    color: var(--content-color);
    opacity: 0.8;
    text-align: center;
    line-height: 1.5;
  }

  @media (max-width: 800px) {
    .diagram svg {
      width: 100%;
      height: auto;
    }
  }
</style>
